create table UserDepartments(
Department varchar(100) unique
)

insert into UserDepartments (Department) values ('Производство'), 
('Поддержка пользователей'), ('Бухгалтерия'), ('Администрация')

create table Users (
UID int primary key,
Name varchar(100) not null,
Login varchar(20) unique,
Email varchar(20) unique,
Department varchar(100),
foreign key (Department) references UserDepartments (Department)
)

create table Projects (
PID int primary key,
BelongingToTheUser int,
Title varchar(100) not null,
Description text,
StartDate Date,
FinishDate Date,
foreign key (BelongingToTheUser) references Users (UID)
)

create table TaskStatuses(
Status varchar(100) unique
)

insert into TaskStatuses (Status) values ('Новая'), ('Переоткрыта'), 
('Выполняется'), ('Закрыта')

create table Tasks (
BelongingToTheProject int,
TaskExecutor int,
TaskCreator int not null,
Heading varchar(100) not null,
Priority int,
Description text, 
Status varchar(100),
Evaluation int,
Costs int,
foreign key (BelongingToTheProject) references Projects (PID),
foreign key (TaskExecutor) references Users (UID),
foreign key (TaskCreator) references Users (UID),
foreign key (Status) references TaskStatuses (Status)
)

insert into Users (UID, Name, Login, Email, Department) values 
('1', 'Касаткин Артём', 'kasatkin', 'a.kasatkin@mail.ru', 'Администрация'),
('2', 'Петрова София', 'petrova', 's.petrova@mail.ru', 'Бухгалтерия'),
('3', 'Дроздов Фёдор', 'drozdov', 'f.drozdov@mail.ru', 'Администрация'),
('4', 'Иванова Василина', 'ivanova', 'v.ivanova@mail.ru', 'Бухгалтерия'),
('5', 'Беркут Алексей', 'berkut', 'a.berkut@mail.ru', 'Поддержка пользователей'),
('6', 'Белова Вера', 'belova', 'v.belova@mail.ru', 'Производство'),
('7', 'Макенрой Алексей', 'mcenroe', 'a.mcenroe@mail.ru', 'Производство')

insert into Projects (PID, Title, StartDate) values 
('1', 'РТК', '01/31/2022'),
('5', 'Поддержка', '06/07/2022')

insert into Projects (PID, Title, StartDate, FinishDate) values 
('2', 'СС.Коннект', '02/23/2023', '11/30/2023'),
('3', 'Демо-Сибирь', '05/11/2022', '02/28/2023'),
('4', 'МВД-Онлайн', '05/22/2022', '03/31/2023')

INSERT INTO Tasks (BelongingToTheProject, TaskExecutor, TaskCreator, Heading, Priority, Status, Evaluation) VALUES
('1', '1', '2','Автоматизация учета рабочего времени сотрудников', 60, 'Выполняется', 10),
('1', '2', '3', 'Разработка мобильного приложения для онлайн-обучения', 10, 'Новая', 40),
('2', '3', '4', 'Создание платформы для управления проектами', 70, 'Переоткрыта', 20),
('2', '4', '5', 'Оптимизация процесса обработки заказов и доставки', 40, 'Закрыта', 8),
('3', '5', '6', 'Разработка системы мониторинга здоровья пациентов', 90, 'Выполняется', 12),
('3', '6', '7', 'Интеграция и анализ данных для принятия решений', 5, 'Новая', 16),
('4', '7', '1', 'Создание веб-сервиса для бронирования гостиничных номеров', 50, 'Выполняется', 18),
('4', '1', '3', 'Разработка игрового приложения для обучения детей математике', 30, 'Закрыта', 6),
('5', '3', '5', 'Оптимизация работы call-центра с помощью AI', 45, 'Закрыта', 10),
('5', '5', '7', 'Создание платформы для онлайн-консультаций специалистов', 55, 'Переоткрыта', 12);

1.3
a
select * from Tasks
b
select Name, Department from Users
c
select Login, Email from Users
d
select * FROM Tasks WHERE Priority > 50
e
select distinct Name from Users join Tasks on UID = TaskExecutor
f
select distinct TaskExecutor, TaskCreator from Tasks
k
select * from Tasks where TaskCreator <> 2 and TaskExecutor in (4, 5)

1.4
alter table Tasks add column CreationDate Date
insert into Tasks (TaskCreator, Heading, TaskExecutor, CreationDate) values
('2', 'Купить слона', '1', '01/01/2016'),
('2', 'Продать слона', '1', '01/02/2016'),
('2', 'Больше не покупать слона', '1', '01/02/2016')

select * from Tasks where TaskExecutor = '1' and CreationDate = '01/01/2016' 
or CreationDate = '01/02/2016' or CreationDate = '01/03/2016'

1.5
select * from Tasks join Users on TaskExecutor = UID where  Name = 'Петрова' and
Department in ('Администрация', 'Бухгалтерия', 'Производство')

select * from Tasks, Users where TaskExecutor = UID and  Name = 'Петрова' and
Department in ('Администрация', 'Бухгалтерия', 'Производство')

1.6
INSERT INTO Tasks (BelongingToTheProject, TaskCreator, Heading, Priority, Status, Evaluation) VALUES
('5', '4','Собрать компьютер', 60, 'Выполняется', 10),
('4', '7', 'Разобрать компьютер', 10, 'Новая', 40),
('3', '5', 'Продать компьютер', 70, 'Переоткрыта', 20)

select * from Tasks where TaskExecutor IS null

update Tasks set TaskExecutor = 2 where Heading = 'Собрать компьютер'
update Tasks set TaskExecutor = 2 where Heading = 'Разобрать компьютер'
update Tasks set TaskExecutor = 2 where Heading = 'Продать компьютер'

1.7
create table Tasks2 (like Tasks)

insert into Tasks2 select * from Tasks

1.8
select * from Users where substring (Name from position(' ' in Name) -1) not like 'а%' and Login like '%r%'
and substring(Name from position (' ' in Name) +1) not like '%а'
